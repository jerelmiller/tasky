window.Animations=function(){var a,b;return b=function(){},iterateAnimations=function(a,b){b=b||"[data-animate]",$(b).each(function(b,c){var d,e;d=$(c),e=d.data("animate"),a(d,e)})},a={animateIn:function(a,c){a=a||b,iterateAnimations(function(b,c){c.delay=c.delay||0,setTimeout(function(){b.addClass("in"),a(b)},c.delay)},c)},animateOut:function(a,c){a=a||b,iterateAnimations(function(a){a.removeClass("in")},c)},listen:function(){var a=this;iterateAnimations(function(c,d){d.onEvent&&(c.on("animateIn",function(){a.animateIn(b,c)}),c.on("animateOut",function(){a.animateOut(b,c)}))})}}}(),window.Tasky=function(){var a,b,c;return a={},c={create:function(a,b,c){$.ajax("/tasks",{type:"POST",data:a,success:b,error:c})},"delete":function(a,b,c){$.ajax("/tasks/"+a,{type:"DELETE",success:b,error:c})},update:function(a,b,c,d){$.ajax("/tasks/"+a,{type:"PUT",data:b,success:c,error:d})},finish:function(a,b,c){$.ajax("/tasks/"+a+"/finish",{type:"PUT",success:b,error:c})},unfinish:function(a,b,c){$.ajax("/tasks/"+a+"/unfinish",{type:"PUT",success:b,error:c})}},b={bindCreateTask:function(){var a=this;$createTask=$(".create-task");var b=function(){setTimeout(function(){$createTask.find("input, textarea").val("")},1e3)};$(".add-task").click(function(){a.animateCreateTask("animateIn")}),$(".cancel-task-button").click(function(){a.animateCreateTask("animateOut"),b()}),$(".create-task-button").click(function(){var d=$createTask.find('input[type="text"]').val(),e=$createTask.find("textarea").val();c.create({title:d,body:e},function(c){a.animateCreateTask("animateOut"),b(),$(".search").after(a.taskHTML(c)),Animations.listen(),$(".task").first().trigger("animateIn"),a.checkTaskMessage()},function(a){var b=a.responseJSON.errors,c=Object.keys(b).map(function(a){return b[a].message});console.log(c.join("<br>"))})})},bindTaskActions:function(){var a=this;$(document).on("click",".delete-task",function(){var b,d,e;b=$(this),e=b.parents(".task"),d=a._taskId(b),c.delete(d,function(){e.trigger("animateOut"),setTimeout(function(){e.remove(),a.checkTaskMessage()},500)},function(a){console.log("Error"),console.log(a)})}),$(document).on("click",".edit-task",function(){var a,b;a=$(this),b=a.parents(".task"),b.removeClass("transition-all slide"),b.addClass("edit-mode")}),$(document).on("click",".update-task",function(){var a,b,d,e,f,g,h,i,j;a=$(this),d=a.parents(".task"),b=d.data("task"),e=d.find(".task-title"),f=d.find(".task-description"),g=d.find("input"),h=d.find("textarea"),i=g.val(),j=h.val(),c.update(b,{title:i,body:j},function(){e.text(i),f.text(j),d.removeClass("edit-mode"),setTimeout(function(){d.addClass("transition-all slide")},500)},function(a){console.log("error updating"),console.log(a)})}),$(document).on("click",".task-action",function(){var b,d,e;b=$(this),d=a._taskId(b),e=b.hasClass("finished"),e?c.unfinish(d,function(){b.removeClass("finished")}):c.finish(d,function(){b.addClass("finished")})})},checkTaskMessage:function(){$noTasks=$(".no-tasks"),taskLength=$(".task").length,setTimeout(function(){$noTasks.trigger(taskLength>0?"animateOut":"animateIn")})},taskHTML:function(a){return options='{ "onEvent": true }',"<li class='task grow transition-all slide' data-animate='"+options+"' data-task='"+a._id+'\'><div class="task-action"></div><h5 class="no-margin red task-title">'+a.title+'</h5><input type="text" maxlength="70" name="title" value="'+a.title+'"><textarea maxlength="270">'+a.body+'</textarea><button class="update-task background-less full-width">Update Task</button><div class="task-description">'+a.body+'</div><div class="task-actions"><i class="fui-new edit-task"></i><i class="fui-cross delete-task"></i></div></li>'},animateCreateTask:function(a){$createTask=$(".create-task"),$createTask.find("[data-animate]").trigger(a),$createTask.trigger(a)},_taskId:function(a){return $(a).parents(".task").data("task")}},a.Tasks={Index:function(){b.bindCreateTask(),b.bindTaskActions(),b.checkTaskMessage()}},a}();